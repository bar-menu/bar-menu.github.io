<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <title>Test Parametri Telegram</title>
    <style>
        body { font-family: sans-serif; padding: 15px; }
        pre { background-color: #f0f0f0; padding: 10px; border: 1px solid #ccc; word-wrap: break-word; white-space: pre-wrap;}
    </style>
</head>
<body>
    <h1>Dati di Avvio Telegram</h1>

    <p><strong>Parametro <code>start_param</code> (da initDataUnsafe):</strong></p>
    <pre id="startParam"></pre>

    <p><strong>Parametro <code>tgWebAppStartParam</code> (da URL search):</strong></p>
    <pre id="tgWebAppStartParam"></pre>

    <p><strong><code>window.location.search</code>:</strong></p>
    <pre id="locationSearch"></pre>

    <p><strong><code>Telegram.WebApp.initData</code> (grezzo):</strong></p>
    <pre id="initDataRaw"></pre>

    <p><strong><code>Telegram.WebApp.initDataUnsafe</code> (JSON):</strong></p>
    <pre id="initDataUnsafe"></pre>

    <script>
        const tg = window.Telegram.WebApp;

        tg.ready(); // Annuncia che l'app Ã¨ pronta

        // Prova a leggere da initDataUnsafe.start_param
        document.getElementById('startParam').textContent =
            (tg.initDataUnsafe && tg.initDataUnsafe.start_param) ? tg.initDataUnsafe.start_param : "Non presente in initDataUnsafe";

        // Prova a leggere tgWebAppStartParam dall'URL
        let paramFromUrl = "Non trovato nell'URL";
        try {
            const urlParams = new URLSearchParams(window.location.search);
            const val = urlParams.get('tgWebAppStartParam');
            if (val) {
                paramFromUrl = val;
            }
        } catch(e) {
            paramFromUrl = "Errore lettura URL: " + e.message;
        }
        document.getElementById('tgWebAppStartParam').textContent = paramFromUrl;

        document.getElementById('locationSearch').textContent = window.location.search || "Vuoto";
        document.getElementById('initDataRaw').textContent = tg.initData || "Non presente";
        document.getElementById('initDataUnsafe').textContent = JSON.stringify(tg.initDataUnsafe, null, 2) || "Non presente";

    </script>
</body>
</html>